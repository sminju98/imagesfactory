# Flutter í¬ë¡œìŠ¤í”Œë«í¼ ê¸°ìˆ  ëª…ì„¸ì„œ
# imagesfactory Mobile App

**ë¬¸ì„œ ë²„ì „**: 1.0  
**ì‘ì„±ì¼**: 2025-11-23  
**í”Œë«í¼**: iOS 15+, Android 8.0+

---

## ğŸ“‹ ê°œìš”

imagesfactory ëª¨ë°”ì¼ ì•±ì€ Flutter 3.xë¥¼ ì‚¬ìš©í•˜ì—¬ iOSì™€ Androidë¥¼ ë™ì‹œì— ì§€ì›í•˜ëŠ” í¬ë¡œìŠ¤í”Œë«í¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤.

---

## ğŸ— ì „ì²´ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Flutter App (Dart)              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Presentation Layer (UI)           â”‚ â”‚
â”‚  â”‚  - Widgets, Screens, Animations    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Business Logic Layer              â”‚ â”‚
â”‚  â”‚  - BLoC/Cubit (State Management)  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Data Layer                        â”‚ â”‚
â”‚  â”‚  - Repositories, Data Sources      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚           â”‚           â”‚
           â†“           â†“           â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Firebase â”‚  â”‚  REST  â”‚  â”‚  Local  â”‚
    â”‚          â”‚  â”‚  API   â”‚  â”‚ Storage â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’» ê¸°ìˆ  ìŠ¤íƒ

### Core
- **Flutter**: 3.16+ (Stable)
- **Dart**: 3.2+
- **Platform**: iOS 15+, Android API 26+ (8.0)

### ìƒíƒœ ê´€ë¦¬
- **flutter_bloc**: 8.1+ (BLoC íŒ¨í„´)
- **equatable**: 2.0+ (ìƒíƒœ ë¹„êµ)
- **hydrated_bloc**: 9.1+ (ìƒíƒœ ì˜ì†ì„±)

### Firebase
- **firebase_core**: 2.24+
- **firebase_auth**: 4.15+
- **cloud_firestore**: 4.13+
- **firebase_storage**: 11.5+
- **firebase_messaging**: 14.7+ (í‘¸ì‹œ ì•Œë¦¼)
- **firebase_analytics**: 10.7+
- **firebase_crashlytics**: 3.4+

### HTTP & API
- **dio**: 5.4+ (HTTP í´ë¼ì´ì–¸íŠ¸)
- **retrofit**: 4.0+ (API ì¸í„°í˜ì´ìŠ¤)
- **json_serializable**: 6.7+ (JSON ì§ë ¬í™”)

### ë¡œì»¬ ì €ì¥ì†Œ
- **hive**: 2.2+ (ê²½ëŸ‰ DB)
- **shared_preferences**: 2.2+ (ì„¤ì • ì €ì¥)
- **sqflite**: 2.3+ (SQLite, í•„ìš”ì‹œ)

### UI/UX
- **flutter_svg**: 2.0+ (SVG ì´ë¯¸ì§€)
- **cached_network_image**: 3.3+ (ì´ë¯¸ì§€ ìºì‹±)
- **shimmer**: 3.0+ (ë¡œë”© ìŠ¤ì¼ˆë ˆí†¤)
- **lottie**: 2.7+ (ì• ë‹ˆë©”ì´ì…˜)
- **flutter_staggered_grid_view**: 0.7+ (ê·¸ë¦¬ë“œ)

### ê²°ì œ
- **in_app_purchase**: 3.1+ (ì•± ë‚´ êµ¬ë§¤)
- **stripe_flutter**: 10.1+ (Stripe ê²°ì œ)
- **flutter_inapp_purchase**: 5.4+ (í†µí•© ê²°ì œ)

### ìœ í‹¸ë¦¬í‹°
- **intl**: 0.18+ (ë‹¤êµ­ì–´, ë‚ ì§œ)
- **url_launcher**: 6.2+ (ì™¸ë¶€ ë§í¬)
- **image_picker**: 1.0+ (ì´ë¯¸ì§€ ì„ íƒ)
- **share_plus**: 7.2+ (ê³µìœ )
- **path_provider**: 2.1+ (íŒŒì¼ ê²½ë¡œ)
- **permission_handler**: 11.1+ (ê¶Œí•œ)
- **connectivity_plus**: 5.0+ (ë„¤íŠ¸ì›Œí¬ ìƒíƒœ)

### ê°œë°œ ë„êµ¬
- **flutter_launcher_icons**: 0.13+ (ì•± ì•„ì´ì½˜)
- **flutter_native_splash**: 2.3+ (ìŠ¤í”Œë˜ì‹œ)
- **build_runner**: 2.4+ (ì½”ë“œ ìƒì„±)
- **flutter_test**: SDK ê¸°ë³¸

---

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
imagesfactory_app/
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ main.dart                    # ì•± ì§„ì…ì 
â”‚   â”œâ”€â”€ app.dart                     # Material App ì„¤ì •
â”‚   â”œâ”€â”€ config/                      # ì„¤ì •
â”‚   â”‚   â”œâ”€â”€ routes.dart              # ë¼ìš°íŒ…
â”‚   â”‚   â”œâ”€â”€ theme.dart               # í…Œë§ˆ
â”‚   â”‚   â””â”€â”€ constants.dart           # ìƒìˆ˜
â”‚   â”œâ”€â”€ core/                        # í•µì‹¬ ê¸°ëŠ¥
â”‚   â”‚   â”œâ”€â”€ error/                   # ì—ëŸ¬ ì²˜ë¦¬
â”‚   â”‚   â”œâ”€â”€ network/                 # ë„¤íŠ¸ì›Œí¬
â”‚   â”‚   â””â”€â”€ utils/                   # ìœ í‹¸ë¦¬í‹°
â”‚   â”œâ”€â”€ features/                    # ê¸°ëŠ¥ë³„ ëª¨ë“ˆ
â”‚   â”‚   â”œâ”€â”€ auth/                    # ì¸ì¦
â”‚   â”‚   â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ datasources/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ repositories/
â”‚   â”‚   â”‚   â”œâ”€â”€ domain/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ entities/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ repositories/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ usecases/
â”‚   â”‚   â”‚   â””â”€â”€ presentation/
â”‚   â”‚   â”‚       â”œâ”€â”€ bloc/
â”‚   â”‚   â”‚       â”œâ”€â”€ pages/
â”‚   â”‚   â”‚       â””â”€â”€ widgets/
â”‚   â”‚   â”œâ”€â”€ generation/              # ì´ë¯¸ì§€ ìƒì„±
â”‚   â”‚   â”œâ”€â”€ points/                  # í¬ì¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ profile/                 # í”„ë¡œí•„
â”‚   â”‚   â””â”€â”€ history/                 # íˆìŠ¤í† ë¦¬
â”‚   â””â”€â”€ shared/                      # ê³µìœ  ì»´í¬ë„ŒíŠ¸
â”‚       â”œâ”€â”€ widgets/                 # ê³µí†µ ìœ„ì ¯
â”‚       â””â”€â”€ utils/                   # ê³µí†µ ìœ í‹¸
â”œâ”€â”€ assets/                          # ì •ì  ìì‚°
â”‚   â”œâ”€â”€ images/
â”‚   â”œâ”€â”€ icons/
â”‚   â”œâ”€â”€ fonts/
â”‚   â””â”€â”€ lottie/
â”œâ”€â”€ android/                         # Android ì„¤ì •
â”œâ”€â”€ ios/                             # iOS ì„¤ì •
â”œâ”€â”€ test/                            # í…ŒìŠ¤íŠ¸
â””â”€â”€ pubspec.yaml                     # ì˜ì¡´ì„±
```

---

## ğŸ”§ ì£¼ìš” êµ¬í˜„ ì‚¬í•­

## 1. Firebase ì´ˆê¸°í™”

### lib/main.dart
```dart
import 'package:flutter/material.dart';
import 'package:firebase_core/firebase_core.dart';
import 'package:flutter_bloc/flutter_bloc.dart';
import 'firebase_options.dart';
import 'app.dart';

void main() async {
  WidgetsFlutterBinding.ensureInitialized();
  
  // Firebase ì´ˆê¸°í™”
  await Firebase.initializeApp(
    options: DefaultFirebaseOptions.currentPlatform,
  );
  
  // BLoC ì˜µì €ë²„ ì„¤ì • (ë””ë²„ê¹…)
  Bloc.observer = AppBlocObserver();
  
  runApp(const ImagesfactoryApp());
}
```

### firebase_options.dart (ìë™ ìƒì„±)
```dart
// Firebase CLIë¡œ ìƒì„±: flutterfire configure
class DefaultFirebaseOptions {
  static FirebaseOptions get currentPlatform {
    if (kIsWeb) {
      throw UnsupportedError('Web is not supported');
    }
    switch (defaultTargetPlatform) {
      case TargetPlatform.android:
        return android;
      case TargetPlatform.iOS:
        return ios;
      default:
        throw UnsupportedError('Platform not supported');
    }
  }

  static const FirebaseOptions android = FirebaseOptions(
    apiKey: 'AIzaSyAFehtzPYQTzXscJPm2-yqKK5GGXKQDIX0',
    appId: '1:629353944984:android:...',
    messagingSenderId: '629353944984',
    projectId: 'imagefactory-5ccc6',
    storageBucket: 'imagefactory-5ccc6.firebasestorage.app',
  );

  static const FirebaseOptions ios = FirebaseOptions(
    apiKey: 'AIzaSyA...',
    appId: '1:629353944984:ios:...',
    messagingSenderId: '629353944984',
    projectId: 'imagefactory-5ccc6',
    storageBucket: 'imagefactory-5ccc6.firebasestorage.app',
    iosClientId: '629353944984.apps.googleusercontent.com',
    iosBundleId: 'com.imagesfactory.app',
  );
}
```

---

## 2. ì¸ì¦ (Firebase Auth)

### Data Layer
```dart
// lib/features/auth/data/datasources/auth_remote_datasource.dart
import 'package:firebase_auth/firebase_auth.dart';
import 'package:google_sign_in/google_sign_in.dart';

abstract class AuthRemoteDataSource {
  Future<User> signInWithEmail(String email, String password);
  Future<User> signUpWithEmail(String email, String password, String name);
  Future<User> signInWithGoogle();
  Future<void> signOut();
  User? getCurrentUser();
}

class AuthRemoteDataSourceImpl implements AuthRemoteDataSource {
  final FirebaseAuth _auth;
  final GoogleSignIn _googleSignIn;

  AuthRemoteDataSourceImpl(this._auth, this._googleSignIn);

  @override
  Future<User> signInWithEmail(String email, String password) async {
    try {
      final credential = await _auth.signInWithEmailAndPassword(
        email: email,
        password: password,
      );
      return credential.user!;
    } on FirebaseAuthException catch (e) {
      throw _handleAuthException(e);
    }
  }

  @override
  Future<User> signUpWithEmail(
    String email,
    String password,
    String name,
  ) async {
    try {
      final credential = await _auth.createUserWithEmailAndPassword(
        email: email,
        password: password,
      );
      
      await credential.user!.updateDisplayName(name);
      await credential.user!.sendEmailVerification();
      
      return credential.user!;
    } on FirebaseAuthException catch (e) {
      throw _handleAuthException(e);
    }
  }

  @override
  Future<User> signInWithGoogle() async {
    try {
      final GoogleSignInAccount? googleUser = await _googleSignIn.signIn();
      if (googleUser == null) throw Exception('Google sign in aborted');

      final GoogleSignInAuthentication googleAuth = 
        await googleUser.authentication;

      final credential = GoogleAuthProvider.credential(
        accessToken: googleAuth.accessToken,
        idToken: googleAuth.idToken,
      );

      final userCredential = await _auth.signInWithCredential(credential);
      return userCredential.user!;
    } catch (e) {
      throw Exception('Google sign in failed: $e');
    }
  }

  @override
  Future<void> signOut() async {
    await Future.wait([
      _auth.signOut(),
      _googleSignIn.signOut(),
    ]);
  }

  @override
  User? getCurrentUser() => _auth.currentUser;

  Exception _handleAuthException(FirebaseAuthException e) {
    switch (e.code) {
      case 'user-not-found':
        return Exception('ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
      case 'wrong-password':
        return Exception('ì˜ëª»ëœ ë¹„ë°€ë²ˆí˜¸ì…ë‹ˆë‹¤');
      case 'email-already-in-use':
        return Exception('ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ì´ë©”ì¼ì…ë‹ˆë‹¤');
      case 'weak-password':
        return Exception('ë¹„ë°€ë²ˆí˜¸ê°€ ë„ˆë¬´ ì•½í•©ë‹ˆë‹¤');
      default:
        return Exception('ì¸ì¦ ì˜¤ë¥˜: ${e.message}');
    }
  }
}
```

### Domain Layer
```dart
// lib/features/auth/domain/entities/user_entity.dart
import 'package:equatable/equatable.dart';

class UserEntity extends Equatable {
  final String uid;
  final String email;
  final String displayName;
  final String? photoURL;
  final int points;
  final bool emailVerified;

  const UserEntity({
    required this.uid,
    required this.email,
    required this.displayName,
    this.photoURL,
    required this.points,
    required this.emailVerified,
  });

  @override
  List<Object?> get props => [
    uid,
    email,
    displayName,
    photoURL,
    points,
    emailVerified,
  ];
}

// lib/features/auth/domain/usecases/sign_in_usecase.dart
class SignInUseCase {
  final AuthRepository repository;

  SignInUseCase(this.repository);

  Future<UserEntity> call(String email, String password) {
    return repository.signInWithEmail(email, password);
  }
}
```

### Presentation Layer (BLoC)
```dart
// lib/features/auth/presentation/bloc/auth_bloc.dart
import 'package:flutter_bloc/flutter_bloc.dart';
import 'package:equatable/equatable.dart';

// Events
abstract class AuthEvent extends Equatable {
  @override
  List<Object?> get props => [];
}

class SignInRequested extends AuthEvent {
  final String email;
  final String password;

  SignInRequested(this.email, this.password);

  @override
  List<Object?> get props => [email, password];
}

class SignUpRequested extends AuthEvent {
  final String email;
  final String password;
  final String name;

  SignUpRequested(this.email, this.password, this.name);

  @override
  List<Object?> get props => [email, password, name];
}

class GoogleSignInRequested extends AuthEvent {}

class SignOutRequested extends AuthEvent {}

// States
abstract class AuthState extends Equatable {
  @override
  List<Object?> get props => [];
}

class AuthInitial extends AuthState {}

class AuthLoading extends AuthState {}

class Authenticated extends AuthState {
  final UserEntity user;

  Authenticated(this.user);

  @override
  List<Object?> get props => [user];
}

class Unauthenticated extends AuthState {}

class AuthError extends AuthState {
  final String message;

  AuthError(this.message);

  @override
  List<Object?> get props => [message];
}

// BLoC
class AuthBloc extends Bloc<AuthEvent, AuthState> {
  final SignInUseCase signInUseCase;
  final SignUpUseCase signUpUseCase;
  final SignInWithGoogleUseCase signInWithGoogleUseCase;
  final SignOutUseCase signOutUseCase;

  AuthBloc({
    required this.signInUseCase,
    required this.signUpUseCase,
    required this.signInWithGoogleUseCase,
    required this.signOutUseCase,
  }) : super(AuthInitial()) {
    on<SignInRequested>(_onSignInRequested);
    on<SignUpRequested>(_onSignUpRequested);
    on<GoogleSignInRequested>(_onGoogleSignInRequested);
    on<SignOutRequested>(_onSignOutRequested);
  }

  Future<void> _onSignInRequested(
    SignInRequested event,
    Emitter<AuthState> emit,
  ) async {
    emit(AuthLoading());
    try {
      final user = await signInUseCase(event.email, event.password);
      emit(Authenticated(user));
    } catch (e) {
      emit(AuthError(e.toString()));
    }
  }

  // ë‚˜ë¨¸ì§€ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬...
}
```

### UI Layer
```dart
// lib/features/auth/presentation/pages/login_page.dart
import 'package:flutter/material.dart';
import 'package:flutter_bloc/flutter_bloc.dart';

class LoginPage extends StatefulWidget {
  @override
  _LoginPageState createState() => _LoginPageState();
}

class _LoginPageState extends State<LoginPage> {
  final _formKey = GlobalKey<FormState>();
  final _emailController = TextEditingController();
  final _passwordController = TextEditingController();

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: BlocConsumer<AuthBloc, AuthState>(
        listener: (context, state) {
          if (state is Authenticated) {
            Navigator.pushReplacementNamed(context, '/home');
          } else if (state is AuthError) {
            ScaffoldMessenger.of(context).showSnackBar(
              SnackBar(content: Text(state.message)),
            );
          }
        },
        builder: (context, state) {
          return SafeArea(
            child: Padding(
              padding: const EdgeInsets.all(24.0),
              child: Form(
                key: _formKey,
                child: Column(
                  mainAxisAlignment: MainAxisAlignment.center,
                  children: [
                    // Logo
                    Text(
                      'imagesfactory',
                      style: Theme.of(context).textTheme.headlineLarge,
                    ),
                    const SizedBox(height: 48),
                    
                    // Email
                    TextFormField(
                      controller: _emailController,
                      decoration: const InputDecoration(
                        labelText: 'ì´ë©”ì¼',
                        prefixIcon: Icon(Icons.email),
                      ),
                      validator: (value) {
                        if (value == null || value.isEmpty) {
                          return 'ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”';
                        }
                        return null;
                      },
                    ),
                    const SizedBox(height: 16),
                    
                    // Password
                    TextFormField(
                      controller: _passwordController,
                      decoration: const InputDecoration(
                        labelText: 'ë¹„ë°€ë²ˆí˜¸',
                        prefixIcon: Icon(Icons.lock),
                      ),
                      obscureText: true,
                      validator: (value) {
                        if (value == null || value.isEmpty) {
                          return 'ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”';
                        }
                        return null;
                      },
                    ),
                    const SizedBox(height: 24),
                    
                    // Login Button
                    SizedBox(
                      width: double.infinity,
                      child: ElevatedButton(
                        onPressed: state is AuthLoading
                            ? null
                            : () {
                                if (_formKey.currentState!.validate()) {
                                  context.read<AuthBloc>().add(
                                        SignInRequested(
                                          _emailController.text,
                                          _passwordController.text,
                                        ),
                                      );
                                }
                              },
                        child: state is AuthLoading
                            ? const CircularProgressIndicator()
                            : const Text('ë¡œê·¸ì¸'),
                      ),
                    ),
                    const SizedBox(height: 16),
                    
                    // Google Sign In
                    OutlinedButton.icon(
                      onPressed: state is AuthLoading
                          ? null
                          : () {
                              context.read<AuthBloc>().add(
                                    GoogleSignInRequested(),
                                  );
                            },
                      icon: const Icon(Icons.g_mobiledata),
                      label: const Text('Googleë¡œ ë¡œê·¸ì¸'),
                    ),
                  ],
                ),
              ),
            ),
          );
        },
      ),
    );
  }
}
```

---

## 3. ì´ë¯¸ì§€ ìƒì„±

### Generation BLoC
```dart
// lib/features/generation/presentation/bloc/generation_bloc.dart
class GenerationBloc extends Bloc<GenerationEvent, GenerationState> {
  final CreateGenerationUseCase createGenerationUseCase;
  final GetGenerationStatusUseCase getGenerationStatusUseCase;
  
  GenerationBloc({
    required this.createGenerationUseCase,
    required this.getGenerationStatusUseCase,
  }) : super(GenerationInitial()) {
    on<CreateGenerationRequested>(_onCreateGenerationRequested);
    on<GenerationStatusPolled>(_onGenerationStatusPolled);
  }

  Future<void> _onCreateGenerationRequested(
    CreateGenerationRequested event,
    Emitter<GenerationState> emit,
  ) async {
    emit(GenerationCreating());
    try {
      final generationId = await createGenerationUseCase(
        CreateGenerationParams(
          prompt: event.prompt,
          email: event.email,
          models: event.models,
        ),
      );
      
      emit(GenerationCreated(generationId));
      
      // Start polling
      add(GenerationStatusPolled(generationId));
    } catch (e) {
      emit(GenerationError(e.toString()));
    }
  }

  Future<void> _onGenerationStatusPolled(
    GenerationStatusPolled event,
    Emitter<GenerationState> emit,
  ) async {
    try {
      await for (final status in getGenerationStatusUseCase(event.id)) {
        if (status.status == 'completed') {
          emit(GenerationCompleted(status));
          break;
        } else if (status.status == 'failed') {
          emit(GenerationError(status.failedReason ?? 'Unknown error'));
          break;
        } else {
          emit(GenerationProcessing(status));
        }
      }
    } catch (e) {
      emit(GenerationError(e.toString()));
    }
  }
}
```

### Generation UI
```dart
// lib/features/generation/presentation/pages/create_page.dart
class CreatePage extends StatefulWidget {
  @override
  _CreatePageState createState() => _CreatePageState();
}

class _CreatePageState extends State<CreatePage> {
  final _promptController = TextEditingController();
  final _emailController = TextEditingController();
  
  final Map<String, int> _selectedModels = {};

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: const Text('ì´ë¯¸ì§€ ìƒì„±'),
      ),
      body: SingleChildScrollView(
        padding: const EdgeInsets.all(16.0),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            // Prompt
            TextField(
              controller: _promptController,
              decoration: const InputDecoration(
                labelText: 'í”„ë¡¬í”„íŠ¸',
                hintText: 'ìƒì„±í•˜ê³  ì‹¶ì€ ì´ë¯¸ì§€ë¥¼ ì„¤ëª…í•´ì£¼ì„¸ìš”...',
              ),
              maxLines: 5,
            ),
            const SizedBox(height: 24),
            
            // Email
            TextField(
              controller: _emailController,
              decoration: const InputDecoration(
                labelText: 'ê²°ê³¼ ë°›ì„ ì´ë©”ì¼',
                prefixIcon: Icon(Icons.email),
              ),
            ),
            const SizedBox(height: 24),
            
            // AI Models
            const Text(
              'AI ëª¨ë¸ ì„ íƒ',
              style: TextStyle(
                fontSize: 18,
                fontWeight: FontWeight.bold,
              ),
            ),
            const SizedBox(height: 16),
            
            ..._buildModelCards(),
            
            const SizedBox(height: 24),
            
            // Cost Summary
            _buildCostSummary(),
            
            const SizedBox(height: 24),
            
            // Generate Button
            SizedBox(
              width: double.infinity,
              child: ElevatedButton(
                onPressed: _onGenerate,
                child: const Text('ì´ë¯¸ì§€ ìƒì„±í•˜ê¸°'),
              ),
            ),
          ],
        ),
      ),
    );
  }

  List<Widget> _buildModelCards() {
    final models = [
      AIModel(
        id: 'dall-e-3',
        name: 'DALL-E 3',
        description: 'ìµœê³  í’ˆì§ˆ',
        pointsPerImage: 200,
      ),
      AIModel(
        id: 'sdxl',
        name: 'Stable Diffusion XL',
        description: 'ë¹ ë¥´ê³  ì €ë ´',
        pointsPerImage: 100,
      ),
      // ...
    ];

    return models.map((model) {
      return Card(
        child: CheckboxListTile(
          title: Text(model.name),
          subtitle: Text('${model.description} â€¢ ${model.pointsPerImage}pt/ì¥'),
          value: _selectedModels.containsKey(model.id),
          onChanged: (selected) {
            setState(() {
              if (selected == true) {
                _selectedModels[model.id] = 10; // ê¸°ë³¸ 10ì¥
              } else {
                _selectedModels.remove(model.id);
              }
            });
          },
          secondary: _selectedModels.containsKey(model.id)
              ? DropdownButton<int>(
                  value: _selectedModels[model.id],
                  items: List.generate(50, (i) => i + 1)
                      .map((count) => DropdownMenuItem(
                            value: count,
                            child: Text('$countì¥'),
                          ))
                      .toList(),
                  onChanged: (count) {
                    setState(() {
                      _selectedModels[model.id] = count!;
                    });
                  },
                )
              : null,
        ),
      );
    }).toList();
  }

  Widget _buildCostSummary() {
    int totalPoints = 0;
    int totalImages = 0;
    
    _selectedModels.forEach((modelId, count) {
      final model = getModelById(modelId);
      totalPoints += model.pointsPerImage * count;
      totalImages += count;
    });

    return Card(
      color: Theme.of(context).colorScheme.primaryContainer,
      child: Padding(
        padding: const EdgeInsets.all(16.0),
        child: Column(
          children: [
            Row(
              mainAxisAlignment: MainAxisAlignment.spaceBetween,
              children: [
                const Text('ì´ ì´ë¯¸ì§€'),
                Text(
                  '$totalImagesì¥',
                  style: const TextStyle(fontWeight: FontWeight.bold),
                ),
              ],
            ),
            const SizedBox(height: 8),
            Row(
              mainAxisAlignment: MainAxisAlignment.spaceBetween,
              children: [
                const Text('ì´ ë¹„ìš©'),
                Text(
                  '$totalPoints í¬ì¸íŠ¸',
                  style: const TextStyle(
                    fontSize: 18,
                    fontWeight: FontWeight.bold,
                  ),
                ),
              ],
            ),
          ],
        ),
      ),
    );
  }

  void _onGenerate() {
    if (_selectedModels.isEmpty) {
      ScaffoldMessenger.of(context).showSnackBar(
        const SnackBar(content: Text('ìµœì†Œ 1ê°œì˜ ëª¨ë¸ì„ ì„ íƒí•´ì£¼ì„¸ìš”')),
      );
      return;
    }

    context.read<GenerationBloc>().add(
          CreateGenerationRequested(
            prompt: _promptController.text,
            email: _emailController.text,
            models: _selectedModels,
          ),
        );
    
    Navigator.pushNamed(context, '/generation/progress');
  }
}
```

---

## 4. í‘¸ì‹œ ì•Œë¦¼ (Firebase Messaging)

### Setup
```dart
// lib/core/services/notification_service.dart
import 'package:firebase_messaging/firebase_messaging.dart';
import 'package:flutter_local_notifications/flutter_local_notifications.dart';

class NotificationService {
  final FirebaseMessaging _messaging = FirebaseMessaging.instance;
  final FlutterLocalNotificationsPlugin _localNotifications =
      FlutterLocalNotificationsPlugin();

  Future<void> initialize() async {
    // ê¶Œí•œ ìš”ì²­
    await _messaging.requestPermission(
      alert: true,
      badge: true,
      sound: true,
    );

    // FCM í† í° ê°€ì ¸ì˜¤ê¸°
    final token = await _messaging.getToken();
    print('FCM Token: $token');
    
    // í† í° ë³€ê²½ ë¦¬ìŠ¤ë„ˆ
    _messaging.onTokenRefresh.listen((token) {
      // ì„œë²„ì— í† í° ì—…ë°ì´íŠ¸
      _updateTokenOnServer(token);
    });

    // ë¡œì»¬ ì•Œë¦¼ ì´ˆê¸°í™”
    const android = AndroidInitializationSettings('@mipmap/ic_launcher');
    const iOS = DarwinInitializationSettings();
    const settings = InitializationSettings(android: android, iOS: iOS);
    
    await _localNotifications.initialize(
      settings,
      onDidReceiveNotificationResponse: _onNotificationTapped,
    );

    // í¬ê·¸ë¼ìš´ë“œ ë©”ì‹œì§€ í•¸ë“¤ëŸ¬
    FirebaseMessaging.onMessage.listen(_handleForegroundMessage);

    // ë°±ê·¸ë¼ìš´ë“œ ë©”ì‹œì§€ í•¸ë“¤ëŸ¬
    FirebaseMessaging.onMessageOpenedApp.listen(_handleBackgroundMessage);
  }

  Future<void> _handleForegroundMessage(RemoteMessage message) async {
    print('Foreground message: ${message.messageId}');
    
    // ë¡œì»¬ ì•Œë¦¼ í‘œì‹œ
    await _showLocalNotification(
      title: message.notification?.title ?? 'imagesfactory',
      body: message.notification?.body ?? '',
      payload: message.data['generationId'],
    );
  }

  Future<void> _showLocalNotification({
    required String title,
    required String body,
    String? payload,
  }) async {
    const androidDetails = AndroidNotificationDetails(
      'imagesfactory_channel',
      'imagesfactory',
      channelDescription: 'imagesfactory ì•Œë¦¼',
      importance: Importance.max,
      priority: Priority.high,
    );

    const iOSDetails = DarwinNotificationDetails();

    const details = NotificationDetails(
      android: androidDetails,
      iOS: iOSDetails,
    );

    await _localNotifications.show(
      0,
      title,
      body,
      details,
      payload: payload,
    );
  }

  void _onNotificationTapped(NotificationResponse response) {
    final payload = response.payload;
    if (payload != null) {
      // í•´ë‹¹ ìƒì„± ì‘ì—… í™”ë©´ìœ¼ë¡œ ì´ë™
      navigatorKey.currentState?.pushNamed(
        '/generation/detail',
        arguments: payload,
      );
    }
  }

  void _handleBackgroundMessage(RemoteMessage message) {
    print('Background message: ${message.messageId}');
    // ì•±ì´ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì•Œë¦¼ì„ íƒ­í–ˆì„ ë•Œ
    _onNotificationTapped(NotificationResponse(
      notificationResponseType: NotificationResponseType.selectedNotification,
      payload: message.data['generationId'],
    ));
  }

  Future<void> _updateTokenOnServer(String token) async {
    // Firestoreì— í† í° ì €ì¥
    final user = FirebaseAuth.instance.currentUser;
    if (user != null) {
      await FirebaseFirestore.instance
          .collection('users')
          .doc(user.uid)
          .update({'fcmToken': token});
    }
  }
}
```

---

## 5. ì•± ê²°ì œ (In-App Purchase)

### iOS (App Store)
```dart
// lib/features/points/data/datasources/payment_datasource.dart
import 'package:in_app_purchase/in_app_purchase.dart';

class PaymentDataSource {
  final InAppPurchase _iap = InAppPurchase.instance;

  Future<void> initializeStore() async {
    final available = await _iap.isAvailable();
    if (!available) {
      throw Exception('Store not available');
    }

    // ìƒí’ˆ ID
    const productIds = {
      'com.imagesfactory.points.starter',
      'com.imagesfactory.points.basic',
      'com.imagesfactory.points.pro',
      'com.imagesfactory.points.business',
    };

    // ìƒí’ˆ ì¡°íšŒ
    final response = await _iap.queryProductDetails(productIds);
    
    if (response.error != null) {
      throw Exception('Failed to query products: ${response.error}');
    }

    // êµ¬ë§¤ ë¦¬ìŠ¤ë„ˆ
    _iap.purchaseStream.listen(_handlePurchaseUpdates);
  }

  Future<void> purchase(String productId) async {
    final products = await _getProducts();
    final product = products.firstWhere((p) => p.id == productId);

    final purchaseParam = PurchaseParam(productDetails: product);
    await _iap.buyConsumable(purchaseParam: purchaseParam);
  }

  void _handlePurchaseUpdates(List<PurchaseDetails> purchases) {
    for (final purchase in purchases) {
      if (purchase.status == PurchaseStatus.purchased) {
        // ì„œë²„ì—ì„œ ê²€ì¦
        _verifyPurchase(purchase);
      } else if (purchase.status == PurchaseStatus.error) {
        // ì—ëŸ¬ ì²˜ë¦¬
        print('Purchase error: ${purchase.error}');
      }

      // ì™„ë£Œ ì²˜ë¦¬
      if (purchase.pendingCompletePurchase) {
        _iap.completePurchase(purchase);
      }
    }
  }

  Future<void> _verifyPurchase(PurchaseDetails purchase) async {
    // ì„œë²„ì—ì„œ ì˜ìˆ˜ì¦ ê²€ì¦
    await _dio.post('/api/payment/verify-ios', data: {
      'receipt': purchase.verificationData.serverVerificationData,
      'productId': purchase.productID,
    });
  }
}
```

### Android (Google Play)
```dart
// ë™ì¼í•œ in_app_purchase íŒ¨í‚¤ì§€ ì‚¬ìš©
// AndroidëŠ” ìë™ìœ¼ë¡œ ì²˜ë¦¬ë¨
```

---

## 6. í…Œë§ˆ & ë‹¤í¬ëª¨ë“œ

```dart
// lib/config/theme.dart
import 'package:flutter/material.dart';

class AppTheme {
  static ThemeData get lightTheme {
    return ThemeData(
      useMaterial3: true,
      colorScheme: ColorScheme.fromSeed(
        seedColor: const Color(0xFF6366F1), // Primary
        brightness: Brightness.light,
      ),
      fontFamily: 'Pretendard',
      elevatedButtonTheme: ElevatedButtonThemeData(
        style: ElevatedButton.styleFrom(
          padding: const EdgeInsets.symmetric(vertical: 16),
          shape: RoundedRectangleBorder(
            borderRadius: BorderRadius.circular(8),
          ),
        ),
      ),
      inputDecorationTheme: InputDecorationTheme(
        border: OutlineInputBorder(
          borderRadius: BorderRadius.circular(8),
        ),
        filled: true,
      ),
    );
  }

  static ThemeData get darkTheme {
    return ThemeData(
      useMaterial3: true,
      colorScheme: ColorScheme.fromSeed(
        seedColor: const Color(0xFF6366F1),
        brightness: Brightness.dark,
      ),
      fontFamily: 'Pretendard',
      // ... ë™ì¼í•œ ìŠ¤íƒ€ì¼
    );
  }
}
```

---

## ğŸ“± í”Œë«í¼ë³„ ì„¤ì •

### iOS ì„¤ì •

#### ios/Runner/Info.plist
```xml
<key>CFBundleDisplayName</key>
<string>imagesfactory</string>

<key>NSCameraUsageDescription</key>
<string>í”„ë¡œí•„ ì‚¬ì§„ì„ ì„¤ì •í•˜ê¸° ìœ„í•´ ì¹´ë©”ë¼ ì ‘ê·¼ì´ í•„ìš”í•©ë‹ˆë‹¤</string>

<key>NSPhotoLibraryUsageDescription</key>
<string>í”„ë¡œí•„ ì‚¬ì§„ì„ ì„ íƒí•˜ê¸° ìœ„í•´ ì‚¬ì§„ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì ‘ê·¼ì´ í•„ìš”í•©ë‹ˆë‹¤</string>

<key>UIBackgroundModes</key>
<array>
  <string>fetch</string>
  <string>remote-notification</string>
</array>
```

### Android ì„¤ì •

#### android/app/build.gradle
```gradle
android {
    defaultConfig {
        applicationId "com.imagesfactory.app"
        minSdkVersion 26
        targetSdkVersion 34
        versionCode 1
        versionName "1.0.0"
    }
}

dependencies {
    implementation platform('com.google.firebase:firebase-bom:32.7.0')
    implementation 'com.google.firebase:firebase-analytics'
}
```

#### android/app/src/main/AndroidManifest.xml
```xml
<uses-permission android:name="android.permission.INTERNET"/>
<uses-permission android:name="android.permission.CAMERA"/>
<uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE"/>

<application
    android:label="imagesfactory"
    android:icon="@mipmap/ic_launcher">
    
    <!-- Firebase Messaging -->
    <service
        android:name="com.google.firebase.messaging.FirebaseMessagingService"
        android:exported="false">
        <intent-filter>
            <action android:name="com.google.firebase.MESSAGING_EVENT"/>
        </intent-filter>
    </service>
</application>
```

---

## ğŸ§ª í…ŒìŠ¤íŠ¸

### ìœ ë‹› í…ŒìŠ¤íŠ¸
```dart
// test/features/auth/domain/usecases/sign_in_usecase_test.dart
import 'package:flutter_test/flutter_test.dart';
import 'package:mockito/mockito.dart';

void main() {
  late SignInUseCase useCase;
  late MockAuthRepository mockRepository;

  setUp(() {
    mockRepository = MockAuthRepository();
    useCase = SignInUseCase(mockRepository);
  });

  test('should sign in successfully', () async {
    // Arrange
    const email = 'test@example.com';
    const password = 'password123';
    final expectedUser = UserEntity(/* ... */);
    
    when(mockRepository.signInWithEmail(email, password))
        .thenAnswer((_) async => expectedUser);

    // Act
    final result = await useCase(email, password);

    // Assert
    expect(result, expectedUser);
    verify(mockRepository.signInWithEmail(email, password));
  });
}
```

### ìœ„ì ¯ í…ŒìŠ¤íŠ¸
```dart
// test/features/auth/presentation/pages/login_page_test.dart
void main() {
  testWidgets('LoginPage renders correctly', (tester) async {
    await tester.pumpWidget(
      MaterialApp(
        home: BlocProvider(
          create: (_) => MockAuthBloc(),
          child: LoginPage(),
        ),
      ),
    );

    expect(find.text('imagesfactory'), findsOneWidget);
    expect(find.byType(TextFormField), findsNWidgets(2));
    expect(find.text('ë¡œê·¸ì¸'), findsOneWidget);
  });
}
```

---

## ğŸš€ ë¹Œë“œ & ë°°í¬

### Android
```bash
# ë””ë²„ê·¸ ë¹Œë“œ
flutter build apk --debug

# ë¦´ë¦¬ì¦ˆ ë¹Œë“œ
flutter build apk --release
flutter build appbundle --release

# Play Store ì—…ë¡œë“œ
# android/key.properties ì„¤ì • í•„ìš”
```

### iOS
```bash
# ë””ë²„ê·¸ ë¹Œë“œ
flutter build ios --debug

# ë¦´ë¦¬ì¦ˆ ë¹Œë“œ
flutter build ios --release

# Xcodeë¡œ ì—´ê¸°
open ios/Runner.xcworkspace

# App Store Connect ì—…ë¡œë“œ
# Xcode > Product > Archive
```

---

**ë¬¸ì„œ íˆìŠ¤í† ë¦¬**
- v1.0 (2025-11-23): ì´ˆì•ˆ ì‘ì„±

