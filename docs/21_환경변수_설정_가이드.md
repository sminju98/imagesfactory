# 환경 변수 설정 가이드

## 개요
ImageFactory 프로젝트의 환경 변수 설정 방법입니다.

## .env.local 파일 생성

프로젝트 루트에 `.env.local` 파일을 생성하고 아래 내용을 복사하여 값을 채워주세요.

```bash
# ===========================================
# ImageFactory 환경 변수 설정
# ===========================================

# -------------------------------------------
# Firebase (클라이언트)
# Firebase 콘솔 > 프로젝트 설정 > 일반에서 확인
# -------------------------------------------
NEXT_PUBLIC_FIREBASE_API_KEY=
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=
NEXT_PUBLIC_FIREBASE_PROJECT_ID=
NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=
NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=
NEXT_PUBLIC_FIREBASE_APP_ID=

# -------------------------------------------
# Firebase Admin (서버)
# 방법 1: 서비스 계정 JSON을 Base64로 인코딩
# -------------------------------------------
FIREBASE_SERVICE_ACCOUNT_BASE64=

# 방법 2: 개별 환경 변수
FIREBASE_ADMIN_PROJECT_ID=
FIREBASE_ADMIN_CLIENT_EMAIL=
FIREBASE_ADMIN_PRIVATE_KEY=

# -------------------------------------------
# AI API Keys
# -------------------------------------------
# OpenAI (DALL-E 3, GPT-Image-1, GPT 프롬프트 교정/추천)
# Reels Factory: gpt-5.1 모델 사용 (Step0: 프롬프트 교정, Step2: 콘셉트 생성, Step5: 자막 생성)
OPENAI_API_KEY=sk-...

# Replicate (SDXL, Flux, PixArt, Recraft, Playground, Kandinsky)
REPLICATE_API_TOKEN=r8_...

# xAI (Aurora/Grok)
XAI_API_KEY=xai-...

# Leonardo.ai
LEONARDO_API_KEY=

# Ideogram
IDEOGRAM_API_KEY=

# GoAPI (Midjourney 비공식 API)
# https://www.goapi.ai/ 에서 발급
GOAPI_API_KEY=

# Google AI (Gemini Imagen, Veo3)
# https://aistudio.google.com/app/apikey 에서 발급
# Reels Factory: veo-3.1-generate-preview 모델 사용 (Step4: 영상 생성)
GOOGLE_AI_API_KEY=

# Perplexity (Reels Factory 리서치)
# https://www.perplexity.ai/settings/api 에서 발급
PERPLEXITY_API_KEY=pplx-...

# Google Cloud TTS (Reels Factory TTS)
# GOOGLE_AI_API_KEY 사용 (Veo3와 동일한 키)
# 또는 별도로 GOOGLE_CLOUD_API_KEY 설정 가능
# https://console.cloud.google.com/apis/library/texttospeech.googleapis.com 에서 API 활성화

# -------------------------------------------
# Translation (프롬프트 번역)
# -------------------------------------------
GOOGLE_TRANSLATE_API_KEY=

# -------------------------------------------
# Email (SendGrid)
# -------------------------------------------
SENDGRID_API_KEY=SG....
SENDGRID_FROM_EMAIL=noreply@imagefactory.co.kr

# -------------------------------------------
# Payment (토스페이먼츠)
# -------------------------------------------
TOSS_CLIENT_KEY=test_ck_...
TOSS_SECRET_KEY=test_sk_...

# -------------------------------------------
# App 설정
# -------------------------------------------
NEXT_PUBLIC_APP_URL=https://imagefactory.co.kr
CDN_DOMAIN=https://cdn.imagefactory.co.kr

# -------------------------------------------
# 테스트 모드
# -------------------------------------------
TEST_MODE=false
```

## API 키 발급 방법

### 1. OpenAI API
1. https://platform.openai.com/api-keys 접속
2. "Create new secret key" 클릭
3. 발급된 키를 `OPENAI_API_KEY`에 설정

### 2. Replicate API
1. https://replicate.com/account/api-tokens 접속
2. "Create token" 클릭
3. 발급된 키를 `REPLICATE_API_TOKEN`에 설정

### 3. xAI (Grok/Aurora)
1. https://console.x.ai/ 접속
2. API 키 발급
3. `XAI_API_KEY`에 설정
4. **Reels Factory**: `grok-2-vision-1212` 모델 사용 (Step3: 대본 생성)

### 4. Ideogram
1. https://ideogram.ai/manage-api 접속
2. API 키 발급
3. `IDEOGRAM_API_KEY`에 설정

### 5. GoAPI (Midjourney)
1. https://www.goapi.ai/ 접속
2. 회원가입 후 API 키 발급
3. `GOAPI_API_KEY`에 설정
4. 참고: Midjourney 비공식 API이므로 정책 변경될 수 있음

### 6. SendGrid
1. https://app.sendgrid.com/settings/api_keys 접속
2. "Create API Key" 클릭
3. 발급된 키를 `SENDGRID_API_KEY`에 설정

### 6. Perplexity API
1. https://www.perplexity.ai/settings/api 접속
2. API 키 발급
3. `PERPLEXITY_API_KEY`에 설정
4. **Reels Factory**: `sonar-pro` 모델 사용 (Step1: 리서치)

### 7. Google Veo3 (영상 생성)
1. **API 키 발급**: Google AI Studio에서 Veo3 API 키 발급
   - https://aistudio.google.com/app/apikey
   - 또는 Google Cloud Console에서 API 키 생성
2. **환경 변수 설정**: 
   - `GOOGLE_AI_API_KEY` 또는 `GOOGLE_VEO3_API_KEY`에 API 키 설정
   - Reels Factory Step4에서 사용 (영상 생성)
3. **모델**: `veo-3.1-generate-preview` (최신 Veo 3.1 모델)
4. **사용 패키지**: `@google/genai` (Google GenAI SDK)
5. 참고: Veo3는 비동기 작업으로 영상을 생성하며, 완료까지 약 1-5분 소요

### 8. Google Cloud Text-to-Speech (Gemini TTS)
1. **서비스 계정 생성**: Google Cloud Console에서 서비스 계정 생성
   - https://console.cloud.google.com/iam-admin/serviceaccounts?project=imagefactory-5ccc6
   - 서비스 계정 이름: `gemini-tts-service`
   - 역할: `Cloud Text-to-Speech API 사용자`
   - JSON 키 파일 다운로드

2. **Text-to-Speech API 활성화**:
   - https://console.cloud.google.com/apis/library/texttospeech.googleapis.com?project=imagefactory-5ccc6
   - "사용" 버튼 클릭
   - 또는 명령어: `gcloud services enable texttospeech.googleapis.com --project=imagefactory-5ccc6`

3. **환경 변수 설정**: 
   - `GOOGLE_APPLICATION_CREDENTIALS`: 서비스 계정 JSON 파일 경로 (예: `./imagefactory-5ccc6-ef0b85c83dfe.json`)
   - `GOOGLE_CLOUD_PROJECT_ID`: Google Cloud 프로젝트 ID (기본값: `imagefactory-5ccc6`)
   - Reels Factory Step5에서 사용 (TTS + 자막 생성)

4. **모델**: `gemini-2.5-flash-tts` (Gemini TTS 모델)

5. **한국어 음성 모델 옵션**:
   - `ko-KR-Neural2-A`: 한국어 여성 음성 (Neural2, 최신, 기본값)
   - `ko-KR-Neural2-B`: 한국어 남성 음성 (Neural2, 최신)
   - `ko-KR-Wavenet-A`: 한국어 여성 음성 (Wavenet, 고품질)
   - `ko-KR-Wavenet-B`: 한국어 남성 음성 (Wavenet, 고품질)
   - `ko-KR-Standard-A`: 한국어 여성 음성 (Standard, 표준)
   - `ko-KR-Standard-B`: 한국어 남성 음성 (Standard, 표준)

6. **패키지 설치**: `npm install @google-cloud/text-to-speech`

7. 참고: Gemini TTS는 자연어 프롬프트를 통해 스타일, 억양, 속도, 어조, 감정 표현까지 제어 가능

### 9. 토스페이먼츠
1. https://developers.tosspayments.com/ 접속
2. 테스트 키 확인
3. `TOSS_CLIENT_KEY`, `TOSS_SECRET_KEY` 설정

## Firebase Functions 환경 변수

Firebase Functions에서 환경 변수를 사용하려면:

```bash
# Firebase CLI로 설정
firebase functions:config:set openai.key="sk-xxx"
firebase functions:config:set replicate.token="r8_xxx"
firebase functions:config:set sendgrid.key="SG.xxx"

# 또는 .env 파일 사용 (Functions v2)
# functions/.env 파일 생성
```

## 테스트 모드

`TEST_MODE=true`로 설정하면 실제 AI API를 호출하지 않고 더미 이미지를 생성합니다.
개발 및 테스트 시 유용합니다.

```bash
TEST_MODE=true
```
